<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Win10 VSCode 终端美化 | 往往不的攻略笔记</title><meta name=keywords content="terminal,Windows,VSCode"><meta name=description content="想法 VSCode 的终端会调用电脑装好的 shell，例如 cmd 和 Win10 自带的 PowerShell，想要美化就得从 shell 入手。关于这个 Win10 下有两套方案： 使用zsh。安装"><meta name=author content="
作者:&nbsp;往往不"><link rel=canonical href=https://wangwangbu.com/posts/tech/vscode-configuration/vscode-terminal/b-vscode-terminal/><link crossorigin=anonymous href=/assets/css/stylesheet.css rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.js onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://wangwangbu.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://wangwangbu.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://wangwangbu.com/favicon-32x32.png><link rel=apple-touch-icon href=https://wangwangbu.com/apple-touch-icon.png><link rel=mask-icon href=https://wangwangbu.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Win10 VSCode 终端美化"><meta property="og:description" content="想法 VSCode 的终端会调用电脑装好的 shell，例如 cmd 和 Win10 自带的 PowerShell，想要美化就得从 shell 入手。关于这个 Win10 下有两套方案： 使用zsh。安装"><meta property="og:type" content="article"><meta property="og:url" content="https://wangwangbu.com/posts/tech/vscode-configuration/vscode-terminal/b-vscode-terminal/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-03-02T00:00:00+00:00"><meta property="article:modified_time" content="2023-03-03T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Win10 VSCode 终端美化"><meta name=twitter:description content="想法 VSCode 的终端会调用电脑装好的 shell，例如 cmd 和 Win10 自带的 PowerShell，想要美化就得从 shell 入手。关于这个 Win10 下有两套方案： 使用zsh。安装"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://wangwangbu.com/posts/"},{"@type":"ListItem","position":2,"name":"技巧➕","item":"https://wangwangbu.com/posts/tech/"},{"@type":"ListItem","position":3,"name":"Win10 VSCode 终端美化","item":"https://wangwangbu.com/posts/tech/vscode-configuration/vscode-terminal/b-vscode-terminal/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Win10 VSCode 终端美化","name":"Win10 VSCode 终端美化","description":"想法 VSCode 的终端会调用电脑装好的 shell，例如 cmd 和 Win10 自带的 PowerShell，想要美化就得从 shell 入手。关于这个 Win10 下有两套方案： 使用zsh。安装","keywords":["terminal","Windows","VSCode"],"articleBody":"想法 VSCode 的终端会调用电脑装好的 shell，例如 cmd 和 Win10 自带的 PowerShell，想要美化就得从 shell 入手。关于这个 Win10 下有两套方案：\n使用zsh。安装 WSL，在 Ubuntu 子系统中使用 oh-my-zsh 配置 zsh 命令解释器，然后在 VSCode 中安装 Remote-WSL 插件，连接子系统从而使用 zsh，属于是曲线救国。 使用PowerShell。微软的 PowerShell 也可也安装模组提升体验，使用 oh-my-posh 或是 starship 来美化命令行，使用 PSReadline 来优化操作。 两种方法各有利弊，使用 zsh 好处是有丰富好用的插件库，活跃的社区能让终端足够酷炫，但是我还是选择了第二种，可能是觉得微软味更冲。\n美化命令行 准备 Win10 自带的 PowerShell 应该是 5.x 版本，可能不支持一些 Module 的效果，因此先安装最新版本的 PowerShell（\rgithub下载地址）。使用默认地址安装，千万不要改地址，会导致后续无法识别。\n也可以使用winget安装，更方便之后的更新等操作：\n1 winget install Microsoft.PowerShell 安装完后Win+R使用指令pwsh打开。VSCode 默认打开终端也是最新版，我们只用在一个地方配置好即可。\n在配置之前，推荐尝试微软的新终端 Windows Terminal，可配置高颜值，在微软商店就能下载。正常打开就能看到自带PowerShell和安装好的最新版，我们设置默认打开最新版。\n不知道什么原因我另一台电脑只有识别到老版 PowerShell，因此我在终端设置中将老版的可执行文件地址改为新版地址（默认安装地址是C:\\Program Files\\PowerShell\\7\\pwsh.exe）。\n设置完重启终端就能查看到。\n安装模组 首先，前文提到的 PSReadline 随最新版 PowerShell 附赠，不用特意安装。使用Get-Module指令就可以查看安装好的模组列表。在 PowerShell 中安装 posh-git 和 oh-my-posh：\n1 2 Install-Module posh-git -Scope CurrentUser Install-Module oh-my-posh -Scope CurrentUser 其中安装的 oh-my-posh 在执行Import-Module oh-my-posh时提示不成功，需要按照\r官网指引进行安装。指引中可以使用以下两条命令任选一条进行安装：\n1 2 3 winget install JanDeDobbeleer.OhMyPosh #winget # or scoop install https://github.com/JanDeDobbeleer/oh-my-posh/releases/latest/download/oh-my-posh.json #scoop oh-my-posh 的默认版本是高于 2 的，是以 Go 语言编写，适用于多平台。虽然看到说法是 v2 版本打开速度更快，但现在版本有更丰富的主题选择，可以根据个人需求选择。\n接下来设置配置各个模组。\n设置 PSReadline 对模组的设置可以编辑设置文档，打开方式：\n1 notepad $Profile 一开始没有可能会提醒新建一个，点击确定即可。\n在文件中输入以下指令设置 PSReadline：\n1 2 3 4 5 6 Set-PSReadLineOption -PredictionSource History # 设置预测文本来源为历史记录 Set-PSReadlineKeyHandler -Key Tab -Function MenuComplete # tab 显示命令菜单 Set-PSReadLineKeyHandler -Key \"Ctrl+z\" -Function Undo # 设置 Ctrl+z 为撤销 Set-PSReadLineKeyHandler -Key UpArrow -Function HistorySearchBackward # 设置向上键为后向搜索历史记录 Set-PSReadLineKeyHandler -Key DownArrow -Function HistorySearchForward # 设置向下键为前向搜索历史纪录 这些设置都可以参考\r官方文档按需求进行修改。\n设置oh-my-posh 使用 以前使用Import-Module oh-my-posh可以导入，但按照最新文档，需要使用：\n1 oh-my-posh init pwsh | Invoke-Expression posh-git 模块仍然可以使用Import-Module posh-git导入。\n添加并保存好设置文档后，重启终端，可以看到乱码但有颜色的命令行。接下来需要添加 Nerd Fonts 字体。\n可以从\rNerd Fonts网站选择喜欢的下载安装，我使用的是 Jetbrains 的 JetBrainsMono Nerd Font，下载的压缩包里可能有很多字体，选择一款 Windows Compatible 的安装即可。\n安装后在终端设置里的默认值外观设置该字体，保存设置切回去就能看到好看的样式。\n输入Get-PoshThemes查看已经预载的样式，我这里使用的是 powerlevel10k_classic 主题。参照\r官网文档，使用 winget 安装的话需要修改启动指令为：\n1 oh-my-posh init pwsh --config $env:POSH_THEMES_PATH\\powerlevel10k_classic.omp.json | Invoke-Expression 使用 scoop 安装的话则需要修改启动指令为：\n1 oh-my-posh init pwsh --config \"$(scoop prefix oh-my-posh)\\themes\\jandedobbeleer.omp.json\" | Invoke-Expression 重启终端就能看到新主题。\n自定义主题 因为我是通过Powershell Module的形式安装，用指令导出主题无效，只好采用手动复制的方式。\n如上设置所示，主题都被存放在$env:POSH_THEMES_PATH\\中，Windows下地址为C:\\Users\\(user_name)\\AppData\\Local\\Programs\\oh-my-posh\\themes。\n复制想要修改的主题，修改后在设置文档中改为自己的主题名即可。\n我主要添加对 conda 的显示。\n支持conda等环境：\n参考\r文档对 Python 类型 Segment 的设置，将desplay_mode属性设置为environment，只有使用虚拟环境时才显示 Python 信息。\n设置的样式如下\n1 2 3 4 5 6 7 8 9 10 11 { \"type\": \"python\", \"style\": \"plain\", \"background\": \"#546E7A\", \"foreground\": \"#98C379\", \"properties\": { \"display_default\": true, \"display_mode\": \"environment\" }, \"template\": \"\\uE235 {{ if .Error }}{{ .Error }}{{ else }}{{ if .Venv }}{{ .Venv }}({{ end }}{{ .Full }}{{ end }}) \" }, 加载太慢问题 参考：https://wdd.js.org/posts/2022/07/igur01/\n设置Vi编辑模式 如果想使用 Vim 模式操作命令行，PSReadline 也提供方法，在设置文档中添加:\n1 Set-PSReadlineOption -EditMode Vi # 设置Vim编辑模式 单单这样设置，插入模式和正常模式切换都是竖线光标，无法区分，添加以下代码区分不同模式光标:\n1 2 3 4 5 6 7 8 9 10 function OnViModeChange { if ($args[0] -eq 'Command') { # Set the cursor to a blinking block. Write-Host -NoNewLine \"`e[1 q\" } else { # Set the cursor to a blinking line. Write-Host -NoNewLine \"`e[5 q\" } } Set-PSReadLineOption -ViModeIndicator Script -ViModeChangeHandler $Function:OnViModeChange 玄学问题：这部分代码要放到之前 PSReadline 的设置上面，否则tab功能会失效，应该是被覆盖了。\n美化 VSCode Terminal 以上步骤设置好，基本打开 VSCode 的终端就是设置好的 PowerShell，这里再提醒一下，安装PowerShell的时候一定要使用默认地址，否则这里会找不到最新版。\n还需要设置终端字体，在设置的terminal.integrated.fontFamily中设置，我设置为JetBrainsMono NF。\n美化 Windows Terminal 未完待续。。。\n","wordCount":"2139","inLanguage":"en","datePublished":"2023-03-02T00:00:00Z","dateModified":"2023-03-03T00:00:00Z","author":{"@type":"Person","name":"往往不"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://wangwangbu.com/posts/tech/vscode-configuration/vscode-terminal/b-vscode-terminal/"},"publisher":{"@type":"Organization","name":"往往不的攻略笔记","logo":{"@type":"ImageObject","url":"https://wangwangbu.com/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://wangwangbu.com/ accesskey=h title="往往不的攻略笔记 (Alt + H)">往往不的攻略笔记</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://wangwangbu.com/search title=🔍探索><span>🔍探索</span></a></li><li><a href=https://wangwangbu.com/ title=🏠出生点><span>🏠出生点</span></a></li><li><a href=https://wangwangbu.com/posts title=📚攻略><span>📚攻略</span></a></li><li><a href=https://wangwangbu.com/archives/ title=📝存档><span>📝存档</span></a></li><li><a href=https://wangwangbu.com/tags title=🏷️词条><span>🏷️词条</span></a></li><li><a href=https://wangwangbu.com/about title=🧍‍♂️角色><span>🧍‍♂️角色</span></a></li><li><a href=https://wangwangbu.com/links title=🤝好友><span>🤝好友</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://wangwangbu.com/>Home</a>&nbsp;»&nbsp;<a href=https://wangwangbu.com/posts/>Posts</a>&nbsp;»&nbsp;<a href=https://wangwangbu.com/posts/tech/>技巧➕</a></div><h1 class=post-title>Win10 VSCode 终端美化</h1><div class=post-meta>创建:&nbsp;<span title='2023-03-02 00:00:00 +0000 UTC'>2023-03-02</span>&nbsp;|&nbsp;更新:&nbsp;2023-03-03&nbsp;|&nbsp;字数:&nbsp;2139字&nbsp;|&nbsp;时长: 5分钟&nbsp;|&nbsp;
作者:&nbsp;往往不
&nbsp;|&nbsp;标签: &nbsp;<ul class=post-tags-meta><a href=https://wangwangbu.com/tags/terminal/>terminal</a>
<a href=https://wangwangbu.com/tags/windows/>、Windows</a>
<a href=https://wangwangbu.com/tags/vscode/>、VSCode</a></ul></div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%e6%83%b3%e6%b3%95 aria-label=想法>想法</a></li><li><a href=#%e7%be%8e%e5%8c%96%e5%91%bd%e4%bb%a4%e8%a1%8c aria-label=美化命令行>美化命令行</a><ul><li><a href=#%e5%87%86%e5%a4%87 aria-label=准备>准备</a></li><li><a href=#%e5%ae%89%e8%a3%85%e6%a8%a1%e7%bb%84 aria-label=安装模组>安装模组</a></li><li><a href=#%e8%ae%be%e7%bd%ae-psreadline aria-label="设置 PSReadline">设置 PSReadline</a></li><li><a href=#%e8%ae%be%e7%bd%aeoh-my-posh aria-label=设置oh-my-posh>设置oh-my-posh</a><ul><li><a href=#%e4%bd%bf%e7%94%a8 aria-label=使用>使用</a></li><li><a href=#%e8%87%aa%e5%ae%9a%e4%b9%89%e4%b8%bb%e9%a2%98 aria-label=自定义主题>自定义主题</a></li><li><a href=#%e5%8a%a0%e8%bd%bd%e5%a4%aa%e6%85%a2%e9%97%ae%e9%a2%98 aria-label=加载太慢问题>加载太慢问题</a></li></ul></li><li><a href=#%e8%ae%be%e7%bd%aevi%e7%bc%96%e8%be%91%e6%a8%a1%e5%bc%8f aria-label=设置Vi编辑模式>设置Vi编辑模式</a></li></ul></li><li><a href=#%e7%be%8e%e5%8c%96-vscode-terminal aria-label="美化 VSCode Terminal">美化 VSCode Terminal</a></li><li><a href=#%e7%be%8e%e5%8c%96-windows-terminal aria-label="美化 Windows Terminal">美化 Windows Terminal</a></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><h2 id=想法>想法<a hidden class=anchor aria-hidden=true href=#想法>#</a></h2><p>VSCode 的终端会调用电脑装好的 shell，例如 cmd 和 Win10 自带的 PowerShell，想要美化就得从 shell 入手。关于这个 Win10 下有两套方案：</p><ol><li><strong>使用zsh</strong>。安装 WSL，在 Ubuntu 子系统中使用 oh-my-zsh 配置 zsh 命令解释器，然后在 VSCode 中安装 Remote-WSL 插件，连接子系统从而使用 zsh，属于是曲线救国。</li><li><strong>使用PowerShell</strong>。微软的 PowerShell 也可也安装模组提升体验，使用 oh-my-posh 或是
<a href=../https:/github.com/starship/starship target=_blank rel=noopener>starship</a> 来美化命令行，使用 PSReadline 来优化操作。</li></ol><p>两种方法各有利弊，使用 zsh 好处是有丰富好用的插件库，活跃的社区能让终端足够酷炫，但是我还是选择了第二种，可能是觉得微软味更冲。</p><h2 id=美化命令行>美化命令行<a hidden class=anchor aria-hidden=true href=#美化命令行>#</a></h2><h3 id=准备>准备<a hidden class=anchor aria-hidden=true href=#准备>#</a></h3><p>Win10 自带的 PowerShell 应该是 5.x 版本，可能不支持一些 Module 的效果，因此先安装最新版本的 PowerShell（
<a href=../https:/github.com/PowerShell/PowerShell target=_blank rel=noopener>github下载地址</a>）。<strong>使用默认地址安装，千万不要改地址，会导致后续无法识别</strong>。</p><p>也可以使用<code>winget</code>安装，更方便之后的更新等操作：</p><div class=highlight><div style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>winget install Microsoft.PowerShell
</span></span></code></pre></td></tr></table></div></div><p>安装完后<code>Win+R</code>使用指令<code>pwsh</code>打开。VSCode 默认打开终端也是最新版，我们只用在一个地方配置好即可。</p><p>在配置之前，推荐尝试微软的新终端 Windows Terminal，可配置高颜值，在微软商店就能下载。正常打开就能看到自带PowerShell和安装好的最新版，我们设置默认打开最新版。</p><p>不知道什么原因我另一台电脑只有识别到老版 PowerShell，因此我在终端设置中将老版的可执行文件地址改为新版地址（默认安装地址是<code>C:\Program Files\PowerShell\7\pwsh.exe</code>）。</p><p>设置完重启终端就能查看到。</p><h3 id=安装模组>安装模组<a hidden class=anchor aria-hidden=true href=#安装模组>#</a></h3><p>首先，前文提到的 PSReadline 随最新版 PowerShell 附赠，不用特意安装。使用<code>Get-Module</code>指令就可以查看安装好的模组列表。在 PowerShell 中安装 posh-git 和 oh-my-posh：</p><div class=highlight><div style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>Install-Module posh-git -Scope CurrentUser
</span></span><span style=display:flex><span>Install-Module oh-my-posh -Scope CurrentUser
</span></span></code></pre></td></tr></table></div></div><p>其中安装的 oh-my-posh 在执行<code>Import-Module oh-my-posh</code>时提示不成功，需要按照
<a href=../https:/ohmyposh.dev/docs/installation/windows target=_blank rel=noopener>官网指引</a>进行安装。指引中可以使用以下两条命令任选一条进行安装：</p><div class=highlight><div style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>winget install JanDeDobbeleer.OhMyPosh <span style=color:#007f7f>#winget</span>
</span></span><span style=display:flex><span><span style=color:#007f7f># or</span>
</span></span><span style=display:flex><span>scoop install https://github.com/JanDeDobbeleer/oh-my-posh/releases/latest/download/oh-my-posh.json <span style=color:#007f7f>#scoop</span>
</span></span></code></pre></td></tr></table></div></div><p>oh-my-posh 的默认版本是高于 2 的，是以 Go 语言编写，适用于多平台。虽然看到说法是 v2 版本打开速度更快，但现在版本有更丰富的主题选择，可以根据个人需求选择。</p><p>接下来设置配置各个模组。</p><h3 id=设置-psreadline>设置 PSReadline<a hidden class=anchor aria-hidden=true href=#设置-psreadline>#</a></h3><p>对模组的设置可以编辑设置文档，打开方式：</p><div class=highlight><div style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>notepad $Profile
</span></span></code></pre></td></tr></table></div></div><p>一开始没有可能会提醒新建一个，点击确定即可。</p><p>在文件中输入以下指令设置 PSReadline：</p><div class=highlight><div style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">5
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">6
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>Set-PSReadLineOption -PredictionSource History <span style=color:#007f7f># 设置预测文本来源为历史记录</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>Set-PSReadlineKeyHandler -Key Tab -Function MenuComplete <span style=color:#007f7f># tab 显示命令菜单</span>
</span></span><span style=display:flex><span>Set-PSReadLineKeyHandler -Key <span style=color:#0ff;font-weight:700>&#34;Ctrl+z&#34;</span> -Function Undo <span style=color:#007f7f># 设置 Ctrl+z 为撤销</span>
</span></span><span style=display:flex><span>Set-PSReadLineKeyHandler -Key UpArrow -Function HistorySearchBackward <span style=color:#007f7f># 设置向上键为后向搜索历史记录</span>
</span></span><span style=display:flex><span>Set-PSReadLineKeyHandler -Key DownArrow -Function HistorySearchForward <span style=color:#007f7f># 设置向下键为前向搜索历史纪录</span>
</span></span></code></pre></td></tr></table></div></div><p>这些设置都可以参考
<a href="../https:/docs.microsoft.com/en-us/powershell/module/psreadline/?view=powershell-7.2" target=_blank rel=noopener>官方文档</a>按需求进行修改。</p><h3 id=设置oh-my-posh>设置oh-my-posh<a hidden class=anchor aria-hidden=true href=#设置oh-my-posh>#</a></h3><h4 id=使用>使用<a hidden class=anchor aria-hidden=true href=#使用>#</a></h4><p>以前使用<code>Import-Module oh-my-posh</code>可以导入，但按照最新文档，需要使用：</p><div class=highlight><div style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>oh-my-posh init pwsh | Invoke-Expression
</span></span></code></pre></td></tr></table></div></div><p>posh-git 模块仍然可以使用<code>Import-Module posh-git</code>导入。</p><p>添加并保存好设置文档后，重启终端，可以看到乱码但有颜色的命令行。接下来需要添加 Nerd Fonts 字体。</p><p>可以从
<a href=../https:/www.nerdfonts.com/font-downloads target=_blank rel=noopener>Nerd Fonts网站</a>选择喜欢的下载安装，我使用的是 Jetbrains 的 JetBrainsMono Nerd Font，下载的压缩包里可能有很多字体，选择一款 Windows Compatible 的安装即可。</p><p>安装后在终端设置里的默认值外观设置该字体，保存设置切回去就能看到好看的样式。</p><p>输入<code>Get-PoshThemes</code>查看已经预载的样式，我这里使用的是 powerlevel10k_classic 主题。参照
<a href=../https:/ohmyposh.dev/docs/installation/windows target=_blank rel=noopener>官网文档</a>，使用 winget 安装的话需要修改启动指令为：</p><div class=highlight><div style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>oh-my-posh init pwsh --config $env:POSH_THEMES_PATH<span style=color:#0ff;font-weight:700>\p</span>owerlevel10k_classic.omp.json | Invoke-Expression
</span></span></code></pre></td></tr></table></div></div><p>使用 scoop 安装的话则需要修改启动指令为：</p><div class=highlight><div style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>oh-my-posh init pwsh --config <span style=color:#0ff;font-weight:700>&#34;</span><span style=color:#fff;font-weight:700>$(</span>scoop prefix oh-my-posh<span style=color:#fff;font-weight:700>)</span><span style=color:#0ff;font-weight:700>\themes\jandedobbeleer.omp.json&#34;</span> | Invoke-Expression
</span></span></code></pre></td></tr></table></div></div><p>重启终端就能看到新主题。</p><h4 id=自定义主题>自定义主题<a hidden class=anchor aria-hidden=true href=#自定义主题>#</a></h4><p>因为我是通过<code>Powershell Module</code>的形式安装，用指令导出主题无效，只好采用手动复制的方式。</p><p>如上设置所示，主题都被存放在<code>$env:POSH_THEMES_PATH\</code>中，Windows下地址为<code>C:\Users\(user_name)\AppData\Local\Programs\oh-my-posh\themes</code>。</p><p>复制想要修改的主题，修改后在设置文档中改为自己的主题名即可。</p><p>我主要添加对 conda 的显示。</p><p><strong>支持conda等环境：</strong></p><p>参考
<a href=../https:/ohmyposh.dev/docs/segments/python target=_blank rel=noopener>文档</a>对 Python 类型 Segment 的设置，将<code>desplay_mode</code>属性设置为<code>environment</code>，只有使用虚拟环境时才显示 Python 信息。</p><p>设置的样式如下</p><div class=highlight><div style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 5
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 6
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 7
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 8
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 9
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">10
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">11
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=font-weight:700>&#34;type&#34;</span>: <span style=color:#0ff;font-weight:700>&#34;python&#34;</span>,
</span></span><span style=display:flex><span>    <span style=font-weight:700>&#34;style&#34;</span>: <span style=color:#0ff;font-weight:700>&#34;plain&#34;</span>,
</span></span><span style=display:flex><span>    <span style=font-weight:700>&#34;background&#34;</span>: <span style=color:#0ff;font-weight:700>&#34;#546E7A&#34;</span>,
</span></span><span style=display:flex><span>    <span style=font-weight:700>&#34;foreground&#34;</span>: <span style=color:#0ff;font-weight:700>&#34;#98C379&#34;</span>,
</span></span><span style=display:flex><span>    <span style=font-weight:700>&#34;properties&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=font-weight:700>&#34;display_default&#34;</span>: <span style=color:#fff;font-weight:700>true</span>,
</span></span><span style=display:flex><span>    <span style=font-weight:700>&#34;display_mode&#34;</span>: <span style=color:#0ff;font-weight:700>&#34;environment&#34;</span>
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    <span style=font-weight:700>&#34;template&#34;</span>: <span style=color:#0ff;font-weight:700>&#34;\uE235 {{ if .Error }}{{ .Error }}{{ else }}{{ if .Venv }}{{ .Venv }}({{ end }}{{ .Full }}{{ end }}) &#34;</span>
</span></span><span style=display:flex><span>}<span style=color:red>,</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=加载太慢问题>加载太慢问题<a hidden class=anchor aria-hidden=true href=#加载太慢问题>#</a></h4><p>参考：https://wdd.js.org/posts/2022/07/igur01/</p><h3 id=设置vi编辑模式>设置Vi编辑模式<a hidden class=anchor aria-hidden=true href=#设置vi编辑模式>#</a></h3><p>如果想使用 Vim 模式操作命令行，PSReadline 也提供方法，在设置文档中添加:</p><div class=highlight><div style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>Set-PSReadlineOption -EditMode Vi <span style=color:#007f7f># 设置Vim编辑模式</span>
</span></span></code></pre></td></tr></table></div></div><p>单单这样设置，插入模式和正常模式切换都是竖线光标，无法区分，添加以下代码区分不同模式光标:</p><div class=highlight><div style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 5
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 6
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 7
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 8
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272"> 9
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#727272">10
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#fff;font-weight:700>function</span> OnViModeChange {
</span></span><span style=display:flex><span>    <span style=color:#fff;font-weight:700>if</span> ($args[0] -eq <span style=color:#0ff;font-weight:700>&#39;Command&#39;</span>) {
</span></span><span style=display:flex><span>        <span style=color:#007f7f># Set the cursor to a blinking block.</span>
</span></span><span style=display:flex><span>        Write-Host -NoNewLine <span style=color:#0ff;font-weight:700>&#34;`e[1 q&#34;</span>
</span></span><span style=display:flex><span>    } <span style=color:#fff;font-weight:700>else</span> {
</span></span><span style=display:flex><span>        <span style=color:#007f7f># Set the cursor to a blinking line.</span>
</span></span><span style=display:flex><span>        Write-Host -NoNewLine <span style=color:#0ff;font-weight:700>&#34;`e[5 q&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>Set-PSReadLineOption -ViModeIndicator Script -ViModeChangeHandler $Function:OnViModeChange
</span></span></code></pre></td></tr></table></div></div><p><strong>玄学问题</strong>：这部分代码要放到之前 PSReadline 的设置上面，否则tab功能会失效，应该是被覆盖了。</p><h2 id=美化-vscode-terminal>美化 VSCode Terminal<a hidden class=anchor aria-hidden=true href=#美化-vscode-terminal>#</a></h2><p>以上步骤设置好，基本打开 VSCode 的终端就是设置好的 PowerShell，这里再提醒一下，<strong>安装PowerShell的时候一定要使用默认地址，否则这里会找不到最新版</strong>。</p><p>还需要设置终端字体，在设置的<code>terminal.integrated.fontFamily</code>中设置，我设置为<code>JetBrainsMono NF</code>。</p><h2 id=美化-windows-terminal>美化 Windows Terminal<a hidden class=anchor aria-hidden=true href=#美化-windows-terminal>#</a></h2><p>未完待续。。。</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://wangwangbu.com/tags/terminal/>terminal</a></li><li><a href=https://wangwangbu.com/tags/windows/>Windows</a></li><li><a href=https://wangwangbu.com/tags/vscode/>VSCode</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://wangwangbu.com/>往往不的攻略笔记</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>